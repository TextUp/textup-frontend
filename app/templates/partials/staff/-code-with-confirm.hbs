{{#hide-away tabindex=false
    doRegister=(action (mut codeDropdown))
    classNames='form-element'
    bodyFocusOnOpenSelector='.start-focus'
    onOpen=(action (mut staff.lockCode) '')
    onClose=(route-action 'revert' staff
        (action (mut newCPassword) null))
    bodyClass='pad-all' as |hideAway|}}
    <div class='form-element'>
        <label for='Your Password' class='control-label'>Your Password</label>
        {{input type='password'
            class='form-control start-focus'
            placeholder='Your Password'
            value=newCPassword}}
    </div>
    <div class='form-element'>
        <label for='New Lock Code' class='control-label'>New Lock Code</label>
        {{lock-control val=staff.lockCode
            lockOnMultipleFailure=false
            numDigits=4
            doUpdate=(action (mut staff.lockCode))}}
    </div>
    {{#if (and newCPassword staff.lockCode)}}
        <div class="pad-t text-center">
            <button class="btn" type='button'
                onclick={{hideAway.actions.close}}>
                Cancel
            </button>
            {{async-button classNames='btn btn-default'
                disableWhen=(not (v-get staff 'isValid'))
                action=(route-action 'validate'
                        authManager.authUser.username newCPassword
                    (route-action 'persist' staff hideAway.actions.close))
                default='Update'
                pending='Updating...'}}
        </div>
    {{/if}}
{{else}}
    <button class="btn btn-span" type='button'>
        Update lock code
        <span class="fa fa-caret-down"></span>
    </button>
{{/hide-away}}
