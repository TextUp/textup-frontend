{{!-- REGARDING THE CONVOLUTED DELETION OPERATION:
    we revert the note then set the deleted flag to true then persist because
    we can't update an invalid note and we don't want to pre-emptively rollback
    any unsaved changes in case the user wants to undo the delete operation --}}
{{#slideout-pane
    headerProps=(hash title='Edit Note')
    footerComponent="slideout-pane/actions"
    footerProps=(hash
        showFooter=true
        doPrimary=(if recordNote.toggleNoteDeleteStatus
            (route-action 'revert' recordNote
                (route-action 'mutate' (action (mut recordNote.toggleNoteDeleteStatus)) true
                    (route-action 'persist' recordNote
                        (route-action 'closeAllSlideouts'
                            (route-action 'cleanNoteSlideout')))))
            (route-action 'updateNote' recordNote
                (route-action 'closeAllSlideouts'
                    (route-action 'cleanNoteSlideout'))))
        disablePrimary=(or
            (not contact.allowEdits)
            (not (v-get recordNote 'isValid')))
        primaryLabel=(if recordNote.toggleNoteDeleteStatus 'Confirm Delete' 'Update')
        primaryProgressLabel=(if recordNote.toggleNoteDeleteStatus 'Deleting...' 'Updating')
        primaryClass=(if recordNote.toggleNoteDeleteStatus 'btn btn-danger')
        secondaryLabel=(if recordNote.toggleNoteDeleteStatus 'Undo')
        doSecondary=(if recordNote.toggleNoteDeleteStatus
            (route-action 'mutate'
                (action (mut recordNote.toggleNoteDeleteStatus)) false))
        showDelete=(not recordNote.toggleNoteDeleteStatus)
        doMarkForDelete=(route-action 'mutate'
            (action (mut recordNote.toggleNoteDeleteStatus)) true))
    direction=constants.SLIDEOUT.DIRECTION.RIGHT
    doClose=(route-action 'revert' recordNote
        (route-action 'closeAllSlideouts'
            (route-action 'cleanNoteSlideout')))
    forceKeepOpen=recordNote.isSaving as |slideout|}}
     {{form/record-note class='pad-t'
        recordNote=recordNote
        doAddPhoto=(route-action 'addPhotoToNote' recordNote)
        doRemovePhoto=(route-action 'removePhotoFromNote' recordNote)
        doAddLocation=(route-action 'addLocationToNote' recordNote)
        doRemoveLocation=(route-action 'removeLocationFromNote' recordNote)
        onLocationError=(route-action 'mapError')
        readOnly=(not contact.allowEdits)}}
{{/slideout-pane}}
