{{#slideout-pane
    headerComponent=(component "slideout-pane/title" title="Scheduled Messages")
    direction=(constant "SLIDEOUT.DIRECTION.RIGHT")
    onClose=(service-action "slideoutService" "closeSlideout")}}
    <ul class="result-list">
        {{#each futureMessageOwner.futureMessages as |futureMessage|}}
            {{#hide-show tagName="li" as |hideShow|}}
                {{#future-message classNames="border-b" message=futureMessage}}
                    {{#if (and (service-prop "existingFutureMessageSlideoutService" "shouldAllowEdits")
                        (not futureMessage.isDone))}}
                        <div class="border-l flex__item flex__item--no-shrink">
                            <button class="btn-span btn btn-plain full-height"
                                type="button"
                                onclick={{if hideShow.isOpen
                                    (service-action "existingFutureMessageSlideoutService" "cancelEditing"
                                        futureMessage
                                        hideShow.actions.close)
                                    hideShow.actions.open}}>
                                {{#if hideShow.isOpen}}
                                    <span class="icon-x"></span>
                                {{else}}
                                    <span class="icon-pencil"></span>
                                {{/if}}
                            </button>
                        </div>
                    {{/if}}
                {{/future-message}}
                {{#if hideShow.isOpen}}
                    {{dropdown-controls classNames="border-b"
                        isMarkedForDelete=futureMessage.isDeleted
                        isDirty=futureMessage.isDirty
                        isValid=(v-get futureMessage "isValid")
                        onMarkForDelete=(service-action "dataService" "markForDelete" futureMessage)
                        onUndoDelete=(service-action "dataService" "revert" futureMessage)
                        onCancel=(service-action "existingFutureMessageSlideoutService" "cancelEditing"
                            futureMessage
                            hideShow.actions.close)
                        onSave=(service-action "existingFutureMessageSlideoutService" "saveAfterEditing"
                            futureMessage
                            hideShow.actions.close)}}
                    {{model-form/future-message classNames="pad-t pad-b-double border-b"
                        futureMessage=futureMessage
                        personalNumber=(service-prop "authService" "authUser.personalNumber")
                        onAddImage=(service-action "mediaService" "addImage" futureMessage)
                        onAddAudio=(service-action "mediaService" "addAudio" futureMessage)
                        onRemoveMedia=(service-action "mediaService" "removeMedia" futureMessage)}}
                {{/if}}
            {{/hide-show}}
        {{else}}
            <li class="no-results">
                <p class="margin-b">No scheduled messages yet.</p>
                <button type="button"
                    class="btn-link"
                    onclick={{service-action "newFutureMessageSlideoutService" "openSlideout" model}}>
                    Schedule a message.
                </button>
            </li>
        {{/each}}
    </ul>
{{/slideout-pane}}
